---
title: "[250528] TIL"
excerpt: "ëŒí•€ ì‚¬ìš©ìí•œí…Œ ë°›ì€ í”¼ë“œë°± ë°˜ì˜ ì§„í–‰ì¤‘"

categories:
  - TIL
tags:
  - [TIL]

permalink: /blog/til/250528

toc: true
toc_sticky: true

date: 2025-05-28
last_modified_at: 2025-05-28
---

# Today I Learned (2025-05-28)

## ëŒí•€ ì‚¬ìš©ìí•œí…Œ ë°›ì€ í”¼ë“œë°± ë°˜ì˜ ì§„í–‰ì¤‘

- [ê¸°ëŠ¥ ì œì•ˆ] ì¥ì†Œ ë¦¬ìŠ¤íŠ¸ - ì¥ì†Œ ë¦¬ìŠ¤íŠ¸ì™€ ì¥ì†Œ í•€ ì •ë³´ UI ì¤‘ë³µ

  - https://github.com/100-hours-a-week/7-team-ddb-wiki/issues/64

- [ê¸°ëŠ¥ ì œì•ˆ] ê²€ìƒ‰ ì™„ë£Œ í˜ì´ì§€ -> ìƒì„¸í˜ì´ì§€ -> ë’¤ë¡œê°€ê¸° í´ë¦­ ì‹œ, ê²€ìƒ‰ ì™„ë£Œ í˜ì´ì§€ë•Œ ìƒíƒœ ì €ì¥

  - https://github.com/100-hours-a-week/7-team-ddb-wiki/issues/95

- ì „ì—­ìƒíƒœê´€ë¦¬ë¥¼ ì´ìš©í•´ì„œ ìœ„ ë‚´ìš©ì„ ë°˜ì˜ì¤‘ì´ë‹¤.
- ì•„ë˜ëŠ” ì§„í–‰í•˜ë©´ì„œ ê³µë¶€í•œ ë‚´ìš©ì´ë‹¤.

# ìƒíƒœë€ ?

- í˜„ì¬ ìƒí™©ì„ ë‚˜íƒ€ë‚´ëŠ” ë°ì´í„°

# ì „ì—­ ìƒíƒœ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë„ì…

### ì™œ ì „ì—­ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë„ì…í•´ì•¼í• ê¹Œ?

- ìƒì„¸ í˜ì´ì§€ì— ë‹¤ë…€ì˜¨ ë’¤ì—ë„ ê²€ìƒ‰ í˜ì´ì§€ì˜ UI ìƒíƒœ ìœ ì§€
- ìœ ì €ê°€ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³´ê³  ìˆë˜ ì¤‘ê°„ ì§€ì ì„ ê¸°ì–µí•˜ê³  ëŒì•„ì™”ì„ ë•Œ, UXì— í° ê¸°ì—¬
- ì½”ë“œ êµ¬ì¡° ì •ë¦¬ (ë³µì¡í•œ props drilling ì´ë‚˜ useEffect ë¡œì§ ì¤„ì¼ ìˆ˜ ìˆìŒ)
- [[ê°œë°œ/ë¼ì´ë¸ŒëŸ¬ë¦¬/zustand.md|zustand ë„ì…]]

### ê¸°ë³¸ ì „ì—­ ìƒíƒœì˜ ìƒëª… ì£¼ê¸°ëŠ”?

- ê¸°ë³¸ì ìœ¼ë¡œ í˜ì´ì§€ê°€ ë°”ë€Œê±°ë‚˜ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë°ì´í„°ê°€ ì‚¬ë¼ì§
- ì „ì—­ ìƒíƒœëŠ” ëŒ€ë¶€ë¶„ ë©”ëª¨ë¦¬(RAM)ì—ë§Œ ì €ì¥ë˜ê³ , í˜ì´ì§€ë¥¼ ë²—ì–´ë‚˜ë©´ ë¸Œë¼ìš°ì €ê°€ ë©”ëª¨ë¦¬ë¥¼ ì´ˆê¸°í™”í•˜ê¸° ë•Œë¬¸

| êµ¬ë¶„                         | zustand ê°™ì€ í´ë¼ì´ì–¸íŠ¸ ì „ì—­ ìƒíƒœì™€ì˜ ê´€ê³„ |
| ---------------------------- | ------------------------------------------ |
| **SSR (getServerSideProps)** | âŒ ì§ì ‘ì  ê´€ë ¨ ì—†ìŒ (ë Œë”ë§ ì‹œì  ë‹¤ë¦„)     |
| **ì„œë²„ ì»´í¬ë„ŒíŠ¸ (RSC)**      | âŒ zustand ì ‘ê·¼ ë¶ˆê°€ (ì„œë²„ì—ì„œ ì‹¤í–‰ë¨)     |
| **í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸**      | âœ… zustand ìƒíƒœ ì ‘ê·¼/ìœ ì§€ ê°€ëŠ¥             |
| **ë¸Œë¼ìš°ì € ìƒˆë¡œê³ ì¹¨**        | âŒ zustand ì´ˆê¸°í™”ë¨ (ë©”ëª¨ë¦¬ ì´ˆê¸°í™”)        |
| **í˜ì´ì§€ ì´ë™ (SPA)**        | âœ… zustand ìƒíƒœ ìœ ì§€ë¨                     |

#### SSR + zustand ê°™ì´ ì“°ê¸°

```js
export async function getServerSideProps() {
  const data = await fetch("...");
  return { props: { initialData: data } };
}

// í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸
const Page = ({ initialData }) => {
  const setData = useDataStore((s) => s.setData);
  useEffect(() => {
    setData(initialData);
  }, []);
  return <Component />;
};
```

### ì–´ë–¤ ì •ë³´ë¥¼ ì „ì—­ ìƒíƒœë¡œ ê´€ë¦¬í• ê¹Œ?

```js
type BottomSheetType = 'none' | 'list' | 'pin'

interface BottomSheetState {
  opened: BottomSheetType //
  scrollY: number
  lastPlaceId: string | null
  setOpened: (type: BottomSheetType) => void
  setScrollY: (y: number) => void
  setLastPlaceId: (id: string | null) => void
}

export const useBottomSheetStore = create<BottomSheetState>((set) => ({
  opened: 'none',
  scrollY: 0,
  lastPlaceId: null,
  setOpened: (type) => set({ opened: type }),
  setScrollY: (y) => set({ scrollY: y }),
  setLastPlaceId: (id) => set({ lastPlaceId: id }),
}))
```

### ë°”í…€ì‹œíŠ¸ ì—´ê¸° ë¡œì§

```js
// ë¦¬ìŠ¤íŠ¸ ë°”í…€ì‹œíŠ¸ ì—´ê¸°
const { setOpened, setScrollY } = useBottomSheetStore();

const openListSheet = () => {
  setScrollY(window.scrollY);
  setOpened("list");
};

// í•€ ë°”í…€ì‹œíŠ¸ ì—´ê¸° (ë§ˆì»¤ í´ë¦­ ì‹œ)
const openPinSheet = (placeId: string) => {
  setScrollY(window.scrollY);
  setLastPlaceId(placeId);
  setOpened("pin");
};
```

### ê²€ìƒ‰ ì™„ë£Œ í˜ì´ì§€ ì§„ì… ì‹œ

```js
// pages/search-result.tsx (ì˜ˆì‹œ)
const { opened, scrollY, lastPlaceId } = useBottomSheetStore();

useEffect(() => {
  // í˜ì´ì§€ ì§„ì… ì‹œ ë³µì›
  window.scrollTo(0, scrollY);

  if (opened === "list") {
    openListSheet();
  } else if (opened === "pin" && lastPlaceId) {
    openPinSheet(lastPlaceId);
  }
}, []);
```

### ë™ì‹œ ì—´ë¦¼ ë°©ì§€

```js
{
  opened === "list" && <ListBottomSheet />;
}
{
  opened === "pin" && lastPlaceId && <PinBottomSheet placeId={lastPlaceId} />;
}
```

# ì–•ì€ ë¹„êµ(shallow equality) ì™€ ê¹Šì€ ë¹„êµ(deep equality)

| êµ¬ë¶„      | ì–•ì€ ë¹„êµ (`===`, `shallowEqual`)     | ê¹Šì€ ë¹„êµ (deepEqual, ì¬ê·€ì )                                  |
| --------- | ------------------------------------- | -------------------------------------------------------------- |
| ë¹„êµ ë°©ì‹ | **ì°¸ì¡°ê°’** ë˜ëŠ” **ìµœìƒìœ„ ê°’**ë§Œ ë¹„êµ  | **ëª¨ë“  ì¤‘ì²©ëœ ê°’**ê¹Œì§€ ì „ë¶€ ë¹„êµ                               |
| ì„±ëŠ¥      | ë¹ ë¦„ âš¡                               | ëŠë¦¼ ğŸ¢ (ì¬ê·€ì ìœ¼ë¡œ ëª¨ë“  ê°’ ë¹„êµí•´ì•¼ í•¨)                       |
| ì˜ˆì‹œ      | `===`, `shallowEqual(a, b)`           | `JSON.stringify(a) === JSON.stringify(b)` ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© |
| ì£¼ ì‚¬ìš©ì²˜ | ë¦¬ë Œë” ìµœì í™”, ìƒíƒœê´€ë¦¬, ë³€ê²½ ê°ì§€ ë“± | í…ŒìŠ¤íŠ¸, ë³µì¡í•œ ë™ê¸°í™” ë“±                                       |

| íƒ€ì…      | ì˜ˆì‹œ ì½”ë“œ                                 | ê²°ê³¼    | ì„¤ëª…                          |
| --------- | ----------------------------------------- | ------- | ----------------------------- |
| ê¸°ë³¸ê°’    | `1 === 1`, `'a' === 'a'`, `true === true` | `true`  | ê°’ ìì²´ê°€ ê°™ìŒ                |
| ë°°ì—´      | `[1,2] === [1,2]`                         | `false` | **ë‹¤ë¥¸ ì°¸ì¡°**                 |
| ê°ì²´      | `{a:1} === {a:1}`                         | `false` | **ë‹¤ë¥¸ ì°¸ì¡°**                 |
| í•¨ìˆ˜      | `() => {} === () => {}`                   | `false` | **ë‹¤ë¥¸ ì°¸ì¡°**                 |
| ë™ì¼ ì°¸ì¡° | `const a = [1]; const b = a; a === b`     | `true`  | ê°™ì€ ë©”ëª¨ë¦¬ ì£¼ì†Œ              |
| NaN       | `NaN === NaN`                             | `false` | JSì—ì„œë§Œ íŠ¹ì´í•¨               |
| Object.is | `Object.is(NaN, NaN)`                     | `true`  | ì´ê±´ íŠ¹ë³„íˆ NaNë„ ê°™ë‹¤ê³  ë´ì¤Œ |

ì–•ì€ ë¹„êµ

```js
const obj1 = { a: 1, b: 2 };
const obj2 = { a: 1, b: 2 };

obj1 === obj2; // false (ì°¸ì¡° ë‹¤ë¦„)

// shallowEqual í•¨ìˆ˜
function shallowEqual(a, b) {
  if (a === b) return true;
  const keysA = Object.keys(a);
  const keysB = Object.keys(b);
  if (keysA.length !== keysB.length) return false;

  return keysA.every((key) => a[key] === b[key]);
}

shallowEqual(obj1, obj2); // true (ì–•ê²Œ ê°™ìŒ)
```

ê¹Šì€ ë¹„êµ

```js
const deepEqual = (a, b) => {
  return JSON.stringify(a) === JSON.stringify(b);
};

deepEqual({ a: { x: 1 } }, { a: { x: 1 } }); // true (ê¹Šì€ ë¹„êµ ì„±ê³µ)
```

| íƒ€ì…      | ì–•ì€ ë¹„êµ (===)     | ì–•ì€ ë¹„êµ (`shallowEqual`) | ê¹Šì€ ë¹„êµ            |
| --------- | ------------------- | -------------------------- | -------------------- |
| ì›ì‹œê°’    | âœ… ê°™ìŒ             | âœ… ê°™ìŒ                    | âœ… ê°™ìŒ              |
| ê°ì²´/ë°°ì—´ | âŒ ì°¸ì¡° ë‹¤ë¥´ë©´ ë‹¤ë¦„ | âœ… ìµœìƒìœ„ í‚¤ ê°’ ë¹„êµ       | âœ… êµ¬ì¡° ì „ì²´ ë¹„êµ    |
| í•¨ìˆ˜      | âŒ ì°¸ì¡° ë‹¤ë¥´ë©´ ë‹¤ë¦„ | âŒ ë¹„êµ ëª»í•¨               | âŒ ì¼ë°˜ì ìœ¼ë¡œ ë¶ˆê°€ëŠ¥ |
| ì„±ëŠ¥      | ë¹ ë¦„                | ë¹ ë¦„                       | ëŠë¦¼                 |

# ì–•ì€ ë³µì‚¬(shallow copy) vs ê¹Šì€ ë³µì‚¬(deep copy)

| êµ¬ë¶„        | ì–•ì€ ë³µì‚¬ (Shallow Copy)                   | ê¹Šì€ ë³µì‚¬ (Deep Copy)                          |
| ----------- | ------------------------------------------ | ---------------------------------------------- |
| ì •ì˜        | **1ë‹¨ê³„ê¹Œì§€ë§Œ ë³µì‚¬**. ë‚´ë¶€ ì°¸ì¡°ê°’ì€ ê³µìœ í•¨ | ë‚´ë¶€ì— ìˆëŠ” **ëª¨ë“  ê°’/ê°ì²´ë„ ì¬ê·€ì ìœ¼ë¡œ ë³µì‚¬** |
| ë©”ëª¨ë¦¬ ê³µìœ  | ë‚´ë¶€ ê°ì²´ë‚˜ ë°°ì—´ì€ **ê°™ì€ ì°¸ì¡°ê°’** ì‚¬ìš©    | ë‚´ë¶€ ê°ì²´/ë°°ì—´ê¹Œì§€ **ìƒˆë¡œìš´ ì°¸ì¡°ê°’** ìƒì„±      |
| ì†ë„        | ë¹ ë¦„ âš¡                                    | ëŠë¦¼ ğŸ¢ (ì¬ê·€, ìˆœíšŒê°€ í•„ìš”)                    |
| ì‚¬ìš© ì˜ˆ     | ìƒíƒœ ì¼ë¶€ë§Œ ë°”ê¿€ ë•Œ, ë¹ ë¥´ê²Œ ë³µì‚¬           | ìƒíƒœ ì™„ì „ ë¶„ë¦¬, ì›ë³¸ ì˜í–¥ ì—†ê²Œ í•˜ê³  ì‹¶ì„ ë•Œ    |

```js
const original = {
  name: "Alice",
  tags: ["dev", "frontend"],
};
```

# ì–•ì€ ë³µì‚¬

```js
const shallow = { ...original };

shallow.name = "Bob";
shallow.tags.push("zustand");

console.log(original.tags); // ['dev', 'frontend', 'zustand'] â† ë‚´ë¶€ ë°°ì—´ ê³µìœ ë¨
```

- `...` ì „ê°œ ì—°ì‚°ìë‚˜ `Object.assign()`ì€ **ì–•ì€ ë³µì‚¬**
- `tags` ë°°ì—´ì€ ì—¬ì „íˆ ê°™ì€ ì°¸ì¡°ê°’ â†’ ìˆ˜ì • ì‹œ **ì›ë³¸ì—ë„ ì˜í–¥**

# ê¹Šì€ ë³µì‚¬

```js
const deep = JSON.parse(JSON.stringify(original));

deep.name = "Charlie";
deep.tags.push("react");

console.log(original.tags); // ['dev', 'frontend', 'zustand']
console.log(deep.tags); // ['dev', 'frontend', 'zustand', 'react']
```

| ë³µì‚¬ ë°©ë²•                         | ë³µì‚¬ ê¹Šì´    | íŠ¹ì§•/ì œì•½                                               |
| --------------------------------- | ------------ | ------------------------------------------------------- |
| `{ ...obj }`, `Array.slice()`     | ì–•ì€ ë³µì‚¬    | ê°„ë‹¨í•˜ì§€ë§Œ ë‚´ë¶€ ê°ì²´/ë°°ì—´ì€ ì°¸ì¡° ê³µìœ ë¨                 |
| `JSON.parse(JSON.stringify(obj))` | ê¹Šì€ ë³µì‚¬    | ìˆœí™˜ì°¸ì¡°, `Date`, `Map`, `Set`, í•¨ìˆ˜ í¬í•¨ ì•ˆ ë¨ âŒ      |
| `structuredClone(obj)`            | ê¹Šì€ ë³µì‚¬ âœ… | ë¸Œë¼ìš°ì € ë‚´ì¥, ìµœì‹  í™˜ê²½ì—ì„œ ì•ˆì •ì  (í•¨ìˆ˜ëŠ” ë³µì‚¬ ì•ˆ ë¨) |
| `lodash.cloneDeep(obj)`           | ê¹Šì€ ë³µì‚¬ âœ… | ëª¨ë“  íƒ€ì… ì§€ì›, ìˆœí™˜ ì°¸ì¡°ë„ ë³µì‚¬ ê°€ëŠ¥                   |

# useState ì“¸ ë•Œ ë³µì‚¬ ê´€ë ¨í•´ì„œ ê¼­ ì•Œì•„ì•¼ í•  ì£¼ì˜ì ë“¤

```js
const [user, setUser] = useState({ name: "Alice", age: 20 });

user.age = 21;
setUser(user); // âŒ ì´ê±´ ìƒíƒœ ì•ˆ ë°”ë€œ
```

- user ì—ëŠ” ì°¸ì¡°ê°’. ì§ì ‘ ë°”ê¾¸ë©´ ReactëŠ” ê°’ì´ ì•ˆë°”ë€Œì—ˆë‹¤ê³  íŒë‹¨í•¨

```js
setUser((prev) => ({ ...prev, age: 21 })); // âœ… ì–•ì€ ë³µì‚¬ + ë³€ê²½
```

- ì–•ì€ ë³µì‚¬ì´ê¸° ë•Œë¬¸ì— ì°¸ì¡° ê°’ì´ ë°”ë€Œì–´ì„œ ë¦¬ë Œë”ë§ ë°œìƒ

```js
setObj((prev) => ({
  ...prev,
  nested: {
    ...prev.nested,
    count: prev.nested.count + 1,
  },
}));
```

- ê¹Šì€ êµ¬ì¡°ë©´ ì§ì ‘ ë³µì‚¬ í•„ìš”
